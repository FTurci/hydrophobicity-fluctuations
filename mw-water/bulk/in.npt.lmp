# Coarse-grain water simulation using Stillinger-Weber
units		    real
atom_style	    atomic


variable        N index on      # Newton Setting
variable        w index 10      # Warmup Timesteps
variable        t index 50000	# Main Run Timesteps
variable        m index 10       # Main Run Timestep Multiplier

variable        T equal 426
variable        P equal 1.0
variable        mwMass equal 18.015 
variable        runsteps equal floor($t*$m)


read_data	onlyWater.start

replicate 2 2 2
# change_box all x scale 0.5 y scale 0.5 z scale 0.5

reset_timestep	0

pair_style	sw
pair_coeff	* * mW.sw mW


mass		1 ${mwMass}

neighbor	2 bin #Angstroms
neigh_modify	every 1 delay 4
# zero the momentum
velocity	all zero linear

timestep 5.0
fix		1 all npt temp ${T} ${T} 500 iso ${P} ${P} 500

dump mydump all atom 1000 tj-npt.atom
thermo		100
compute_modify  thermo_temp dynamic/dof yes
thermo_style custom step temp pe etotal press vol density  lx

variable csvname string output.npt.csv
fix extra all print 100 "$(step),$(pe),$(temp),$(press),$(density),$(vol)" file ${csvname} screen no title "step,epair,temperature,pressure,density,volume"


run		${runsteps}