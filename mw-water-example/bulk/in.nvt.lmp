# Coarse-grain water simulation using Stillinger-Weber
units		    real
atom_style	    atomic

variable        w index 10      # Warmup Timesteps
variable        t index 50000	# Main Run Timesteps
variable        m index 1000       # Main Run Timestep Multiplier

variable        T equal 426
variable        mwMass equal 18.015 #grams/mol
variable        runsteps equal floor($t*$m)
variable        desiredRho equal  0.9# density in g/cm^3
read_data	    onlyWater.start
# get more particles
replicate 2 2 2
# calculate half of the box size in armstrongs for a cubic box
variable        num_atoms equal count(all)
variable        hL     equal  (${num_atoms}/0.602214076*${mwMass}/${desiredRho})^(1./3.)*0.5
print        ":: The   "
change_box all x final -${hL} ${hL} y final -${hL} ${hL} z final -${hL} ${hL} 
reset_timestep	0

pair_style	sw
pair_coeff	* * mW.sw mW


mass		1 ${mwMass}

neighbor	2 bin #Angstroms
neigh_modify	every 1 delay 4
# zero the momentum
velocity	all zero linear

timestep 5.0
fix		1 all nvt temp ${T} ${T} 500 

# dump mydump all atom 1000 dump.nvt.rho${desiredRho}.T${T}.atom
thermo		100
thermo_style custom step temp pe etotal press vol density  

variable csvname string output.nvt.rho${desiredRho}.T${T}.csv
fix extra all print 100 "$(step),$(pe),$(temp),$(press),$(density),$(vol)" file ${csvname} screen no title "step,pe,temperature,pressure,density,volume"


run		${runsteps}